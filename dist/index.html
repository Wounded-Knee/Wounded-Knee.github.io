<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"819a0642bb6bef04d9ee995f92cf0a78d0e042f9661bbd0f6ac7dc986905580ba53f36218eb235ea1a74bfdfd5724ceec3e62d0b9801eca7a655f60c7f7c7309673b5dc2dbcd6a47cd28c29ae44f0841b89addedb022a420d9469d7956a5818c0fddb05084c1942061d18d0d4d02629abdce291ae89cdc353e675ddc376b0a14733418f4a41369ebcb45f247f67eee36bd18cfdcf2ec62b6ca501c875bc6a3270c07fd16d52c279a3250835fa106c83aa58956041d304f6047573005a7a3dd331ab059aef955cc13800eba4b9beef34fa91f7f8b2b797bef9b2ba52201c71620032f54f16a0333e84dadd1dc3e09ce6535dd945035089aea6a05dec5ff9e90e5d63044f6939b7073f4ff728b5858f48cc92eec75a46407a5aaeeadfcb8621ea194f2aa291049e03d88484950642b79af0239a86480ac279f86e72c0836385a72e32b3e4183892e35219ff198bc75156350da2aa6069acc9595dd6f02cdd2fd8dda65c66879041879b20b4b09379d188a186fd957b8784fe7959b268c2e2ef5931ff450aa94373b8ea3fc4a45b7c50f9f468d3c1b42c4023a4772f58829a4825f4165ad07a94c168c97402b77bc84c26ad82ef01e0f9284caf074f8b2ad402934ef66ee499aa256ca7f76e5b4f0c82f567e48cc6c4324318257b48a798e4e881616cec817b7256d00053ccec487b6fb92ac2b1c88d574cd3662c6655c814778293639c08ef007d661e59fb03037e62b247da3002d5105c4a47354027591f064793b17ef4bc1fdd1c10553829c5afadb8a4186b61d49f5926b73f9d9241c3ecac8721fe9cb3aa9d90ca9ed1de03bf2b31eeda9d166e279e17972a63544cbe371797e91873f4634314227e9c70fdc6ce52278a0e093f897a15d716d14a738db07848a159936c421b5036ff2847a91c093ae53ce684308f4f8d4f5bc03ea774f79484e5a66c0fb8d676079bb285859dd2c50152b4615e64ad04148bba163d032ea7ab08e88530606e948e4bc3dd6cd3dc58df30bb8913fdb8297c93b444d0e2b950523032537639a354fa6fc6ee67bee3a6dbc07eac58c8dc74b30980268a1a0543e23fc3b8d93581bc2ae1e6a2a0277edbb9e731065497d85caa4b3905b16ddd0527d0207c8963d02a33a56b038e14b869868c1e4c7ce4aea2cd7689b7b76028e45beb9be77db7e397d456f5ab8ebd4e6758d894fd1e525f22cb5e7067be8ebdc6bf01ba0b2627260898f4d984a4475069cf9b1522ffaa1ac554ada9049705f86c7529aea6c8dc5269f5c153073d4fe7f6f45c377b58459c7f352a122c4023137aa24a1c5541e344b51e080a2cb03fc7d459ee0b2e48bce75c4d8af846b8ebb6c75a99acf00224251a4c830d61c37d4ce4a2b40ebc2af28ae51545de21e0a918e05e9d41a09054e9832d51927e1da778a4a218a9b2035b4aaf466849e1544c995984b8dabe6dc1336b87ba803b7acb69750809c71f8bc81f1ee90e5858b056ee5b6a6742a8bef7255c5cbf2258c0cc8672a354d405151176e711d3438f803703198b01a5f955d22a1d6c4266e20d549ca73b09adeb065b54995d94815588dd9e69c354353c05e0e127a9313d496fd7626311cb07915cc2e9e311ce4feb97e5ebc4992794cc40ef0e5b4d234deeef84871369ae25156a003d4fbeb85a22cf011aaf25e178a4bde417e7f9086491c5600609d8ec67b8d41cb99ada25af702e08152b8b34ea35551cb1f12122ddefd4ce33bbc153c98903e109ee60592a5c36207c2bdc84252382ad10702eae8e4baf427fc2e49912bc0a8a8fbad82b5cc617646fd02f498d102da645dccb253822662dde66435190bae9167223a7a45457fda5a59f6c794b4549b8d479459235c5553f5dd884c9adaff9004a3181fc22c26baf5c3ae13aff64f1014c6e6054a58fe83ebe94236b8f49b4013148c03ce6cde8e61a94b7c3306509cfead3cea4c440e61efee0edcba65a478fb20bfa66713de391915e60da03705294e64053c63edcd21db76fa2f00e6ecf386c785fc40a6d1a399b35bd34d70586363489615ee7279abad835e22b6827642fcaa70e54f30927d33a5a82a00a4829cb75c9e19b1175254c625dd9b9c0cf9e5df15f68e66802b54f4136dd2c0343d4d4a59d754aa10232c96db1ae3d8ab9c9acff5e856a5ecda426cad7789a7915f044f79b4f088d1775f072b366c0ee15c4921cb916bb7d9a71256eef06e36e65bb4a6d01b2268fb0b71396b042a820e710b3c4b44690dca517dd4ec9cc5ce06d56c204c3b4d07c31cf724aca90e1403567ae341ebd4c3fc15ceb242f2639dc6276745943ed265c86af413aed30b3da0d89b684464e3ccc4401cf8cc4d9ba18b6cd08fe19cc43516126c0049e197665d6d5aaa6470ee2de699e7e60276b0b0e8e959e44b5e9b691ed42669b85b2faf2bd70219eb4b26661fe6c14ea16a31c442e9196e87d112d8d33e67db58616bc8d0c9f8660b07dcc38bb03b4cbe1d1d33468dd72ef619a4abeb693270d2cbb1874ab3881bfeb4935ba1911370a706a0c4cfbe7df3430af6c49d5981b8a0d7ac0bbaed125d973138a83ba25c9ca6d4ae09a1aeef26482e66863680819beb7bb2e19f2abcb2fc433595520e13a35b440f10f098a59b1805bec9170fb259d5eec2f38c4680f1aaf43b79ceeb5d3628379e35a1afb42d326103d54e67a19ea5a0a0e642b070d6c160e9aefd24628bf74a205cbf4c150c46d9ebecde995e78ef7299e556495bca26548493ec78185f7a85819fd91ad6206f710fc48b3b9948707832ac6b095e20dd5228a86f2085b85df79953410d91e516aba91a8e0ec9d9d72f4d42ddceb80b11814c4d73b6029d009bb58660dae38a81317ae14bf825eb84157d6f3adf91c230a9a92dd506c7ef38e42597f967dd43946daf36897fa7d67c9cfbc4f3276de8f70757657024c4cd73682d565308758fbadb741b30546df4e7607452498796ae2752aa4159da0781a2ca2ddc3eff5c27eac6613a4e7142a86d135364bd1472aaf22dfc910f421c2814663b45c33ba69559586a7da66303b07a78e2b11e165a0cbc944dab7ddf5049026a7be23592d982a09a6dcd7982f6fceb46739065f99df85c78a8b342f4072dfe6f50825fff4ef20bf1dab991e4b4c437bff9c6d5104f37560a5681209d071d1edd0ffdaf1f6795b7ef30f7147d48f5f430233946a37c606d1ad9d1b9f69ae1c2b95a520938d0338f5e992011e969f1389ae92705b7e87d88d862bc7addfe9755cfaf444e9235b3511004b909c6c991162e81d2e2439f4aa431e562ce23779e5c7ee54fd09fcd9bd399bb88898e8901b19b0855bc737e43e2b7a00daa5d5bebeec46a474d40f48848c80570996b995847593c691b2ae25359bf3433d4c2001cd1cc8d3622384001369d227b2c07c86b66ef076b468fa4d62443e2e679d903091cc54e0476abad39ff8f27dc67c2a59888def2ea7b7055f1cdbcd6831a112fad0119fad61eecba42ddc2d2e75cefdb1d8ffe8fd14f472803f9d89a235a0bce311a976dd0e62a64735b126a29a69577da8b5408457f74d3ba32ce5c95421cc1fa85bd25796b9f4aa88b986d5c12165ad3cdd280281a0cc4d6afe1e79aa643df2cbf1c98b5e82d868fe7d1c11e84fb51f67866995135be8aa917919dd731cb255d36771da79317b5530fd58892f22b2daaf83c75e9f762acbd6fe56f088986efce661de05cdf697d9a01fa70fb00d26e344cb4123ec73514fb029f12d55fc38fed040462bc7dfd01c84954276f658ca3e8d23e31f82f8b1770c1a79b04c07b2ce81bf86ee40b38bba5b76b2604183f45b3e4d5aa54f84ce29014b11620c2db57c81159c9e5a0c66df0871a27320ff39f78d8e42ab29a38e533b94ef68652fb01ac9c81a75389f591cb5cefa588d11abdbfbafb7397aee27ea994e9ddf35baebcdf61195f920b6a68b73952158c447ed7c39d3aa846c1386bfb592396bf5bcee5b2b98f561355c89839893096e169787cbedcc4334404309bd49811224bb8de6490c4ab325846c1d1f4c5b52ba30e78be00b712d6d92835578c5db0e3504312035caa3f1273ff349bebfb6235e853dcfa06a9e4dffa58c571cf5eaf1f494e72aa55ddb21fa3044dcab23c3fdc67d6480f7bb0e5331f6c1ed9409f7019b05ff40cddc0a2d450b60576941363cf1c8677b44a20842908d3747fd7c5d90bfcd2df55f755dc7a2ab85ab25fc2a06d1dd3cce26cd07afb0381f6aea4ba65b59ac001049f428c7596a3690e7c915590c8fe2aa54863ced51c0bd75f2943eca15f1a18d86298bfab199cffaecdcb173ec18e1cb7f3a472e87fcca70a071873b28d6eefe3d252e1bd8ddb0a40ca53be5ec5bbdefd01934c051612b6511df16a345bb8283e9c003cc97a1446132225fd43b106e61a27996485f4348e8d5f6bc690ea36f08d2303fa64cd9c0b04b1826ee75032db18998dfe67f1000d0a78250695b39ef3c1a49bcc25555ababd84543813a7e746b65491048c2cec4bc935ec8a4b3fd28d8e18e3581455f1bf4f023294def56f49cb433a7f31a7609bd8435d95163236f96443fc801409cd8e42c2906b1e0ca2880f3f31ad5c8efd7de6c12df8cd46ebb460cc4e09530ae088dcb067c92738fa0fb7ea25056375b163df6e50835a35c884e8fe8ce952d954f55382718f695be1729ec3e3bfe1d801f7be1b6363de8d092d6e3dd520a8fd05dd03a53c15e41165a84540874d8240b4be8b4fdcd476e3d285e8bd802b96a1ebdd3a1c04264f3ed14488e3b5698f509b2672d3012926e4141f7017cf2e1bb5d783e54243b4a8b7020e4380ff08a5ebb3b171eb712b59c47c27c6dd6043d99e94ec950d8a45d17393320d86d1598b69516aa07f0abbcdcbac13416c9566b00ad98e5f8211652f46fc8b11b56afd1dab6402fbab331fbfc4754980c154fbdfee8a4e779e8c5691422ce13465f5bf4899c043fa64203bdef89fa6a15a86c4ab2c2deb1b154e6f8e1dc6fbcfa092ad34e87c88c4b809903bf04aa82551c9c8d065ed0b347405da0c6d783f8c68e2ef4c06b4ce3e6349f23a3098852b088a583693e66f23bea3830a88e65bea8776c32707aa18f71888aa7e68b9085e53bd90abdde48c98b313e2d4232f04febf5593ef3bbaa7c88de491aa1800164a2aa93a6edca2532f284eb60d4cc5a8886b6b7266118a81bbfa8decaa606be09930fd4ae79ccd7afc590d4fc704606da2e411dbeb3458b4ce62e069c2492b972aca9e2ca283d573795e5c0961c4a3e58f72fbe98ce2afbafad3f25b55470340b0457fb80e72d818998952b3acec323d95e1f0e37a61a4e624695dac41ac55a367175c4a2ae9c3ad55976df2e2615a6d03943b71ed1b7267c8ad749b1f576286a7f719259a0624bb55a0a6870f70c5e19589bf7682c71aaae2d54bdcc0f574fbafc439a0cec6cfe3affb0c1d3c2e820d4c879b7bf680e9ed17b72767bff68700fb7cc5c92750a7369607ebf086e48e5773d795507f04ed013b62e61945459f3962fc02ff80140871668809ee56a2663a5b28a02d66748095df90d1669124ac243ea5462a19da6281a2f299c0015a287c227936a28f2992937d0723b2254ca5876307bba1603fd407ec2520d63b6f22ed35977d5f41421762a17995a748494507aec09624c0504962b97d76022f3b1b00074f68570bb229111dcfb0df27d0324dc576a8c979de482ef8be43b9ab2164a1803122d2049d0d28982b6ed35f8f5a2c8c1058b441173ee6ce801c433d6a985991fab6d8ab48fe779730c707aaff3e3fb90021f1f1905da9b1330afbb38c4463b4fb7b19c1bb85b4db0f2b292198d9329a6bca9da324b8cb4c8de589167e6c331f407b2267198870ed0bf5e5865349b85cc990ac6ca8a9f23d2e035e292783ac8b85f1a5beab158260bd9c6efaa6f3c7d1960bbc02459ed6874a4434986cfa71291949c9be71729099d6129ad56e630ccdff8eb888f5ae96697bd3bb8d0ae78eace556bbf5283e22e65dcacd73ad8a04e40f6dc76c0ad30d64bc561f55bc607e8ea9f939c0d412829cd4fca8c55cbff7dcc31b0516b0b1fead3572e3546661d9b20d78c06cb6610d2d1ff066c5cfcbc364d360101b316474976496717516dbfbb827b6cc74969477c06e5bfe5d715a78d0c25692ce7dcf2555308099d5a856e14e31b98555099bfcda3a8d548906fe78f3523f01460066a4a3692a96e0c3715db7ac899db2d148de27c74b35cf3980933b804251b29a56ee9377b0e8e09ecbd373a1945aad5ccb27adc530128ba8ffb610ad3b4e098571a4dd5f77592287dc3568ff217058583cbc2f87f2de5778c48e79bf47d822ed0a6ae15fb109ca25f2677d04e39531177f43afd56b0f64a51114e1aace70b1633a811401e140cc8eea225024a9d876f3f9be4dce01c1d14a32aa5b1098e35eb6a2d509cd36a0f471e81a86bce0d8baf5de81989ef7db44c5a307a9c266d28c4d414032d484fa89398b35b053754f1666117aae83ac3528b056c02df7d7814ed0ecabf79f2bfe596aad6805f5839877a8b54a085f3958827fec385da79f20aa5b337c35ab739739793fa72219d772e5197f28dd600afa000710c3674e9cbae925c2938e015e7dfee332364a04aeb5248f9fbb95ab35f234e88ecf87cf5786532b6d9a66dae03ea0f5e68b4558f03f447e708b176df14701e5f8e12a461fdbff9b68e527c432b688de841222e7efa4dd88aafb05b0536746dc2c81a3c54cce0f8dfd090488e0b81665109403904ff43934613aa583c9de2bec14520c21c6615ce39e446b454a3ee0a939fc757dac2ebc2474741120bd9fb28d1db6b3335f49dfa6cb00f4e8d2956c04e251b5b0c02cdfc2cc38160c1794e7640ab3953b58226a856cf1728a4a49a04b0ee4794b1898ec11e69ada53ceef6a8326f21cc80f2e048f22123e2af0fe3e104a1e51eb5d429a51e0df0ad8955f607e114c3b655ec4543539b7fbf0f8f52f83181959a4812911da740e1ceee3d6be59e6128a0bc071a624ede2c6590bbe4ab5c06cb1cdae7cbf73763d88526d82b466e893939b94010055b0bdd59a233328cf0ce9c22c5d3d12f842a2a7d4b39b906a32aab18f88d1de5dd625e62bfe7778fdb7ab89d49cec30cee2a59dacff8cd236371f7ed24de5656a1a4ee06771d8e87297765faebf64780327a3bdfa21cf2756f34b8f23371739766950d40800dd2326ec7b443a811d73c9f84779cf57cea95eccb338122b52bc140ea06961fe489a812cc082cf9d4f4bb297d761b52047a6696aff7202b99c4bb97c04b5238f0fc0a2c20a18a947ead641099c603f2e727958b99ac3eaf03130059ad2d744b08272fee93662e71fb70e4a41085df65dbe10f4282e2b61594b4fe698f0923e8a931bf3fe503261018d4e879a75b43d150dafc94321f30306af6e4e79c138ce7c36de20eb7dd1f5a3b050cb6514d0d6b5763c7ce33bb35b0e17ab18fb3b0d77f8b4b2ec3ecce33076c31ddbc2ed4b69c680ee08ccbd57f8e97b8e2ed28ca4acf72efc3fd7d169c0815f8f88e1bbc771deacf41ead83dc340858dd207732188f37096573d0fbd5cca7efbda74a5232941d05e7b80a321c5a3fb3974180ffae98dd9cd0c3057f51befe6baa54324f2111e224804a8f56055fb7d5738437797fc7a3f68bcc2523d9621aa586efd1cb4349685588a359dd6d855c24b9f430e58e195a5b57f5b09d9fb790f54946a8ea91bd981c972d7333ba4f8d4f7fc794c146ca519cbb7d03c2830232414d5d2eed43a4e5bdc7710f1332d71d8038b9926de696b9a4f331d22cfc1047c7f65dc2ce90b76c72dae73b44dd53ee3e06cb1e8a7567cc21cc38fa6ba6e6ba9d0e04a87071dea4ff7ce22a3eae0592b68b1045478806767cee847fae710e153c49709d352e8e8fd44e7612acdede8b6a8df705afa0415ccda589d89fb31450921f6f0cfd3318b776fbfeb43fe976b40a97a803bd95850b437cf7fc03dbcdce56c69634562ce4aeedeaaa6d94dfc3cedb8749cb399434508039b024fa77c58bff139435cecdc5fc2b92ae475e70bd80ab69fa283ee0a77fe8feea08a7d1ea734f5983b1c199f5d8e72d59b19e339d3e3cb41919745f2480f3cdf163dbe145a004140e41fab196542221163153dc582373cd1cbee0336e00555d4f6f437700dccf1f8daa22eef6574e3b0380455dda76517f18890c7ba49d4dbee0cf3e556970d2dc20fbb7a353aa60de9a92d44c0edd310cf05d205657c5776084b17aca9ed238f8ff3bc3c143eb09cb0afccfe61ad28cdcba45b75b8077ca26ec6ac9cd0f6d1e4d1330a8cdc93d68cde5472cfcdce3abb51bb3dff510bfdd45159825c9c5b1b7e3d5b7e7ac6351c450f9f6c0b5834028d14704add895c33bbfbca5299701671a423126fa4924eccbcc80393d855743a5d3489966482cf84279d981641ae180af352df823d7655df5f14041de1c53a9c72bca0862b50c55f745f784883e0e2df6d466e0f1c63a221b9d94aa694e75d129122e38f7f4f3d269bc660c26a0b8d9ceb5cd5f0fcf562e0869628114f1e4f192363d6facd3ab8561e29e7306b5efc10bdaf3d09734b12b4519f6089958d96d152bbd9ada2b84b601cbed4e6be162eca862619bf41ceeb3e2df27631608449ddb48cd07756af54feecf71183dd296c97e3e3236a423479ccf194150872b3ea26eb815cbb0aa7618fd352ceafd4008ac84952039bb13533131e69ff12399d2b06c1eb1705fa833ce50b5cd69ac1281d79c20815a83f92a94ad8a606e86edd2114af1b7fb77534d3fa5a1cd22db87633ac3c956c8af47fc543e416cbca21060fe94e6a9c87ad42f1d6fd7f015ea2464b55b54dedf04411fa5843d4dc0df2386572797177af4686e2f87f3f189f8d714fdb24da23eafc7c6b04a8f1f5f34cb60ea7f6bcbacc50c43ebba3bfaae186255bcf95929faad9928b4c5fe94b1845bc33cb2d94668568ea89b4a670b45fb177f0c86d835e9c1ed5184c9eaf8c046760a6095c1dedff83fb5b17a44e69c8bc58d939b311d5d7920b5fd7ad65e769ea60e9abbe3a1569dbe1745dde4c6696010765a19af8cf166965328506322079154e313141304de29c70fcdb2669128f03fa6eb703b853f49394eed705aa7b3e9f338131f00a5bf5be12543189d2f6f5f546fbe3b9701014a1ef9853ca67982e6e9a4cc6e94d16f1ed5e3c9ff41f078fe909d2c535e3f828c0792933b7a7411898b04bd1228ce37264f6f91ecb4c20094f447a607a90158c121045d02dede9db2a27cb1f9ad21fca57a98c8cc708b75c720b5df245dc49f867e2b09720255e48a8a1e6ff20d4350a0520eb0e8a4e5ec63854e13476eeacd0490a3543f035f4c055e21ac0b0e2778a205d1b3bd898a901911c3b299494569da38dde7b3705462f18fd245fd99e031c235abf1833635b003127078973637ad168d859e541cacb010be5bba56636e6cf441c9c8039daaf4c1e5f9761bc21b1c01b527669d750b4bba3ca0496cf0fc1d3cd4851e89db6a5e3aceb1350b5c9368f25f29ddefb7490e691c5e51d1b6625d8b6d90cb897ea0f423d4605f026119a56529addf60ea6b40355eaba739cdb28fc8338d201a207d73667b4679adfe16d67aaf09361997fba669426341cb71b64e253395c60227719c3c625c258f67211054ee930d397da1aee3f1152e91d45dbbcf28fd13ec0cb100de06b35db29bbbbed93eeb3ef830003aecb2b8523134713670fef66334dc8b3104949858d17831e11fec55b5e95498cbc909c9123f9cf94ca51b9506e14124db5ba18441c89fbc4f538a10c9a889765257c2e300e10f2b143892f0d2ade64473c955bce87f47425c11701a65da3709951409a32624920cf0ada5b79e3605593db40010603f6c4cc0d7df4934115a3896993a2300b2d3e22e4166ed886737c60c6c5709a69188058e54dad339a779dcae1ebac22a0622120293f84d4274c9aa4358acc297e97d944903ea8a9bbe6fa4ce36849d41273d633a782bf5204daeb10166a227112e96ad53e4a4f28079a54641341b4244d151403b1a4abf6c151fa594de2110dd60841abf81de8c27b33d15eb3e72de76cdb9fd5a8634c6ce9e5d568848dd3c12999ecb076c43f70884dbd13a706004304cffb1d439c2324ed0fe2ffa50b93cd28f227f2dc74488e6f547de6844b03f5e99575fd0ea0c2ad33faa767d6c14d40152b00eb88e3fbca157a3fd2bb1e7a862aa73ddb86dd54ca8cd064f3c657040693158a2ef664c62270334a74442973164781c8f4b5371a1c8dfb36089815d7561fc2cf26676caea0d6ca04f230a27bf4d89f740d155c77e5ad5d480100956f97f9a9fc74e402699570a6e0f74e3b9ecb3a2b7cdaf1822df12d26f136b371d841f9fe466a1fea8c600276741571cf279181383c40e82a933547b6ae489cfcc35c19c0551dbcd113da0e40c751d7183259e8c87f252a626f868448f4c64a28b18b488972a31484ca2ae084a8d1419191e66b17a242986ebf3d8c180de3e39dd2daf24e9d98da45a0bd317a03fb4481b754c7eeb807dbd6f757219a9c052f181a90eeb6395a1a08144064f78e5b70ba54f9f9e852a32257e362db6b92bf7176f978d4edc89ddc096bf18076370c45fecb211a593891fbd893e9001f492df7ebe44f1bdf776bc885794188ae65091512d00908b06d04e3758994abe249738e4508f0879ae7b63d73d1b17290d75df63caf540125cbdb65fd0ea14553a23bb66ca4d6f7cfb76fec204d5fe4cc460137cadbe584da1d07ae9c09780934bb2732a066166d91ef90c47bb6f6ba59bf15b88020c41e349b5cbea3be86b7c63173e8d74f81946cb24323adad04cf0c59672cb32250e327b8defbe2c8bbd7ff6a0b172c5c6821ccb4558b2a596264ef0c8d70bc60bbdb6ff715dc8dcf5385e2dda96e2553e72fd38b82c1413d470206a67ecd9c1eca38d5b3bd6aca581b78a8321fded81bca9529760d03b0df4413baa35a4c7f4184a2e345ce8e14a7c2e206487d5778ac7c5641f419476be1a3be72948d2b1632f425a867a90a42c09d0ea395fa4830406bfd8b96f2deb5d272bbcdc6724c79e03aa56570d37e076d0b6b359d7b4c40fb21e6b33ffdd83f20af7c6498d1c4fddb3d4837100aef942b08ebafa0864f1312fd608d039b559bf1ad330b2b933ac9f8392bd9f38733e592b94381cf074caa757af944dabbf3ab3715e7402dc7c3b174e043cc06d5862d234601e5e083629d9f203e50d4fa88541134c2c469ee2d8337edf915732e92ee0505de52b3327a5af306c39fb1f8342045403c2ac892239c9868c293269a267322c03af84bc341bcda5575f46d7de91b28f24526da76a68a051760741340d758204ba7485b770b5e9bb5674e13e84f6f67fe64ed4fcb8ba25784b238ef21401ac02e143a1c582bab9449ab281bd18e25c44fa682abfc772188546bfb87200191e8ae8ae74e5906fb4710fbd7497eddf2cccdcc57825b9c5cdca9827cc472551e53785c1583e92a68382aa919246f97f318d2ec7eff1f46f3edc5824a5d05226d8475a7638deefea68f9fcfcd6381d4e215b1c786e4bb4ed57ce1c89c34158d237aa69f3b5de81b340f34c509de9a92a238ec2ea832bc1b17b041069a89901868df51764d0c0e703237e5242d8263b65142c46942dc2812dfd87f657baedef69429e54b28bc2aaf8de66074be22331219a8a6478d0b529ca3366d608b35a8667a5c66aeb3509abd9993b9b90e015dd61b19a04858b5808d36d0172da49590fa9824c8d6505441c94f6e1caf4277fa9029a72b17d77c5691bc5af9b1d89a314a6fa1ee6c641b8f7ab04298b607b63f6f4ba0dd6fcb1b494b8143494a0a83285e7053503ef4c4d5592ebc28a30e825efd42347a2879ccf41b616d520e75c963828dd2b281609e7b37bd18f9cae17f807a5d0b8d87a186552688d0003108d8bc49b74a4b9679e3526544588987b4b10200ae54bdd78e9e7cb91050290cf82d12649df02bb0facffd0fd15b8a9adbba5bc2e2281205c7e8aeb0770de1f1598a582cec58292a93df988e03036ef2ea3cc4ae324a2015def4a577698df1b21d47284925a78c6735a519c0c15adefbf2ac6859c8ab469d932dcc7632d1446a607b54c046595eab1d6daeb3ec8dddbd6981b3de839297e4a69f4deedac88f61669b0574ede691d22cb670a4880f0e48c5eea838c30dcfdac05524dbf4b5c340585533bb374c896acd1b67118ee3c70dd5e141c6c59377d711c5470cbc21e3bbb0c771ed1ee5af508259d8fbc60549106b1988bcafc5f251b6412a3da370ba8df31745bea2c7dfdda847c81f516f03edd91806150df58605da7aa29d06bcfbcaf7c5f2e9b5ab440a21445d3651c390d2d41f1fdb3de3f4c7db8bb141c9321ccf222c6069e3fda2bc7745bfaffebc6b5e9f8f33ece2352e1730058af71c8b873c125cc0a5a09d134b3adf8266d0925edc07bf576723fad8539ce3a6a5a365215e2bafec079220fceef7004886e78487c6646cbfd1eebbe6b3a99e64b4be59bf4b71305d5faf1d8b3af42343d8608374e0d0ad460b0c1ff9677833722d6bfe15f7d2c0aedcb3f19f3de6703f3b9fd443107b9c7be93b8a8d14c6bb9dc42e7b6fc8e9b53fcbe1d1e9aed451a831b18759a1e3f022255467bdc11ec64fef1729a37d69e0fadbc60846e1668ae8f16f82c9eb3485a765ca458ae3cdd3413b2b5e36d6d6662adf7677ffc93820b1906de4548a30c1392b9d87b18ddea54f7f9eb150916f82828213795d16bb1b76e6fdeea2bd37190cdd84d8df1c6d4f92368fd6b4a8b831b9f8f0b2ae15708d9ba01627291534a917ca2342beede2ddc57fdebdba9110249f58224d1c98373eebf7e945a99fdd8003ceb6679ac2e9c33d1268e8fb0ec9a7cf023bdfec1aef9126aeb4e3315a96cc0a43455fbc10531d14290e12bb4857b32821e0cab5ac258d7d006f4bb274f754163aed38514ebd7b316211d1235d934141c42df292ba66002517b05d6d8d48784550e99b9f276e4a8519e8e48d5cbf74a092da1bd088e1d9eb4a015eeb2c463d86de5c2041e4af7a1dd2c95087abe47323df02867e85108247ce962991ab171825f07981757043a7a7ef14a688f004f45aee6b18fdcf4ba7f81bcf89e586fbda12c3d0d0afed8ff4a1c1831bb9466f13fe531e9a025f836d94ef63cb2411ed53086f42da4daaf71bacf0bfdcf99e309a54e44975da5e87a54861066156bf2e36f06bdc1402a98bc71a1a5499a4c48e502dd8c770083b8c9745d569e6361868293142fc5d9923e7c91feef88d3b72a3deedf9b78a4f4a2574659043836eb712c282952ca7c6b4633826d5d2befc8508bf30d196ec4fcdd7885402cc5ff5dba1643bbe2578ccfa6a433828dc216d84ea8c05031c16e5918439869fff0895e067dd2f9037b702c999049216914903c67ca0ca4ec8a6f738b080f8d7d40b55dc8cfe4333cbb4c19e17ff2aa18d0838532259870327d0c2c69661b444977f5f4caf9d6fce7d671c2be501388383c097840ae1429ce0446a80a441d8d447554f3372ca273796890368ed42328559e116fa433231cb3d0e5454ff0986a230ab34132f149218657986f1a03e5be8e11321d468188b9939dbedeff05a9c12b611d293c01970c37f4df5a04e45d271f3524ee3e1a36347b02a65ec3820729730fcc1a35a2b8635c6375cd64ef0bd1d0d48df257bd169b5aac2d0d656e46b737bd601e144e85ce6434f23249faa43f5a742b791d66075d0c73762bfcf62ad923264363a6f9cdc72028718ead40b12410e1c7dca8c8d8b4262417ed5dd7afc6a365d4e3dfad3f8701d75e7c70ee1ba2c526efefca84b3362d353159c6d905af8cf4380d884b2f351d7bbc0f8c988e8656d1976239f93c93e6de6b72a90739871d75dc0536552981d99071294b2619d5991e36869cf517cdc472ed5144968e35e27b74238b4ceec38c17a3329248d5c67cce4c28edb92c43573182f3feb55c33dfc69789776ec11f301c9f280f0f05327c462c1312a073e84c4ccd6acdef29405f4f9a830a9b628270766d9e6250565dc28f275af9bc7ab2a1c75ce5e4aded318f71bd3683f3c0e41b753a60b79ce8e954cb421194d3aa46f44d7fe42ece10a5d22ebf94a2274b3e11bda92867f33d41d333fcfb3fca4ad3ec18b40df6eaf3c507581177492435f53b8f2a5f4a9893f4e5ccc2221a822d0df1e7e771d5fb811f1f861ace31f6e5414c7f8b3bb9aced5f89ca5d7f9ae6bb9310133f1ba724b325906e0218957ada5aa2cd96b8f75b1cf75ccf2d18efb639de34b8b28ccb6afdd7eb5fd61c0b5664947c21f922eb969d6e1cc199e78576b28c76b500305c7e64fe83884aaf77d15b211b5380ce00ad0cbc95ee6cd8610de7f17fc346e3b018606ea73e9a4b988f6a0ab7a2d8c96846f8a1fff4297d1cfb33ee42c0755d92eb4d1824be4dcc0c145d9e60940bdbe3cab39d451514e804bf75068f9cc968f95710b2eed3da6ea8b50e285f2433db7b284b925ddccd10a7a32a59c4b891985a3c850ff44b593501c6b548269ef5ca3c7222d98f158b34c2ab2cbd3083491f13fa3f083b211d1448f19551ab57b191e4f11506d8d1d0955f01f0445e91d585b2017e28b2d9853b7b46b78973249c2ece513657dd3fd55a3608c26c10772dfe15ac9a2f4a76df4f02d1fcc3c7a1c86c68cab4db0a170c87d590939528d3dfa1eff68613a690bf561cf90435adcfe29fc33b0cfffc6e58f4d6ca500011f852167919d13bf3bf9db81b3345e166900c91fa5a680292375daa1545dfc4c38ab48fc7a36d2f873e051ea8f2de7ec224687be8a8078861b4b4a001953fd8dbb98af186e313bfa101472bcfc60e6e4bc697d525ac14785837aa2ecd5d3bbd1736678a39caa0664ef52446cebea4a234ad30735ba376a91c3fef0ad543a6890dd03b1c20f7234dc275eea5eefcbd91162f21efba1c0d545ef092a5bc74ba71e64dc6fab1a10c6b7023874a2fdb63e3ae2a8d1092355ecd39c8faabc5bda36f0ce120e5e00dfe40903972e5eeb01b0d8849ab8754618ed1bdc4e4eb1577298822d946a9dad3f343bf785613a5bf1ec6abb7e20df5eceeae15c0eb3222f9f5902cf14209771e7b0c85d3ebeba21de21216326f3b580978db8436e7c9eeb5741ef1c87f6a42efebe6bcc2e6d52088a0d0645a13a7d7f323ce468d2684ed42d64da7f6bbadf072720246205beff29c816b2a2e633fc273fd5d3f4ab738f832070c03eaf4076afc69a04d2cb6872556d0d9b73bcb4ab306546077dde2b89331f902762603a23014f0949e0b3086b4041714a3e527197a45277388eb10ad01755c53c8bd8800be8a53ecf7e289c3c9eb132f583b64cc1644eb8800b2b41756c2a70ce8f48456a8cfd13f4c6b00d35570170fb9f409d9d76babd2aa4f6066774807821b4ba68b255f99c1c42140625e4c99e5f2a869def4d219bd6de8b244ef928c6577ae87e5a4cf310666ad707d1fe974cd0a7e9f90805f50e6a00456e7e8effb1cf7b4b464c1e44525f1efd3d15a6700517477a4ffafe1f5f62a77bcaa63d1264d5dbcd149a97c51d90cb89464154d5f6edac6282ede9f55c6bcf6bb52910c50b7c2fd00ba46a72e1e8a9a34df04a77f3a90eee2c8ae959fdbe158832765660b89dc7bfdf89e8398b524ea961bdaf14cab3db7891109c175d33db65e5ca35de41a80777ec5fc50406f07da3ea6100a217d1f9caa14a3c70592aee27b9f042f9c9396c46724e8a67b767f59ec30b0f5c87b71d643a93d9d5726f99b02ca6efc13788de35f7d2dc8a5505ded38cf9929761698bed534c9f430fdcd305cc6b91bebd8f68d7b0126b53fedb533204b244521acaf34248ce5c32da82ea6f122cc6599f4939aec4315d0af1fd2767d084037c8cb1003d25c781a4501e469117b8a64d8a36d6a3293ddec6c09adb3aba01d588edcbb2f89d7f26516c71abbc1d66c9b7db39433d85deae0983cbfcf01ceb5e4140f22e7cf7779a460ea89fe731f5c262cf34c0e483776fb57a7b36860897ce73dbeb4af5ba9f8cfff48c05a0d14a1cff557d456a01fbf3fc0622be4f9df674e3d36b7ef5d39e12163a099fd866a205a930edf05ff33c5b7a964a8e474e603c5d145bb3cf906eaa0c203624dfd18a9ed7aec78d439e8f1f2cff77fb659d3e10a7fa015b347b641668da2b718c6dc37f93863a1f9f6f13338b8682719378d4961e62d65dd3fad5a04188c243e03d410633cdbcdd40135bef1a69bef4482c157b4a8a38c32070f0cc9b5c4cff0dfa5f990b0fa446a8d5b51ef682e6bdbf20ff8e67a94f94f4cc06c188d03aa3d7ab39c43e3fc23f654231a0fb1f775b522cac84a8f44f1515a932f7cb9621e82aaa7f3322514d60c064f8f3416d69170623ddddf6f58eb7076d4bd0905935d48743fa5d97d2a73ec9b4f32cedc2ebac5f8e4162dcd1fb3491103e903d733ec3c29433b4bdbad3b127b9f39c44dfff6d16d99dfb30fefd4f03c703c119f5373bec7491e3704594929c8876fe2b3d84a716c41bb8a55054e331c85b9c15a470d62dd58fa9e869787cc0d78ee7fa003cf5d1e056597b17a48b4034c912261a14d0412f548e1b01c7bf1d0ac12b952a1d8bdf322efb1b51f5d3f01569ee1b7f3ed448b811d9d07562b9ba36e99f60304d2818e0cf595e867f0e838300155c6417bb95e03d7a1c1de61943076de2eba8ece1784019fc22070e062b9cab6d122fdce634ab90797aa17c49fba045d44f358af25d1aad0a8fcabe3aa6abef0637c0246cdc5bdad76ca194420d6ffa969128ba69e56b246924bc384b9fbe02f0a3d1caf2aa9cd3bec4a908b108a83b1e37be02c023f47f34fc84641c76b45cce55b5868da5dcff261418a9d1c44bf48c5486ccf305e17056a023f785d18cbf84b9ad46b2e722126adb70f5234a7b44058cc5d7b71b000c819029f9c7e1ccf105b671c583eaade6bc1b8b72a7628b30cd300b6e7d958e52bcd0128c44b8a1ba0192d44aaa2c4c203b62051ed4ae1991f68dc357f4adc746b3e6ffab7e4319d55aef632ea16a41371384199c05fac34cf7b9447a326f056cbd40cb284a18c4c43f05b879f72c5074fd5b821d5a193f2fd6c45e5e8697bbe4de3645c7779166b1c0bd78e6927515b8d32778c86e59dcb14326c716beb10878dfc78bae5b4590c33eb6250038bbe5049baefaa4ebffb100043e9e0fc8a0129791f4164bb0038581943a3822a1eb5bb4c61c36b1d8ef95bacf913262099d5e7c546a90605d68d3df24fb1b23f569e7c73","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"77e6f901fba9b0f8bbb9f62225d7f4f0"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
