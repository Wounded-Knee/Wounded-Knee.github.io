<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"1d4f69dcc5e99ac78e36c02023a68bd3110a6292582da8fef334cf1fa22f7c4a5c69c34209fcc2c159fa1fa1c5e2c9be2effc7f74b91e95fdc35c4806a1557a40f08a863e221dd54aa07f10b9410dd09b64042f340f83efd37e989777207b1b91eaba74644545286969fbbecc50df44c8992c094961c013bb24c83db94afaf8c984dbe7f394f73a85b93f8e0f27017c66cde8cb569d9af3c286fd6337d4e7c60071e8e022110cf9e848204873f4bb3f42b93510427290e2bf79fa580a44c70f719b2f3cae8ca81f80d7df6bfc7a9623daac96a0e6874e18c274d5ffc93ad660a2af6523c6541ff15446530a9b2a83525ed4fea122a70b5af9b7ae79e84cddb54079b4a54a03c84c934572cbedea12267b7a0f77fdc63c4c00ebe35201cab67f20c744699715154491121d86e812d2237f862ccbcd85417595dd76972ff4641f0c700169159b086fbfb6d6fff629a04bc52210abc34d7e6add4ee929db36958010da3f436af0b73d71d287b7fdd99ea24b39e554bd20ca6bacef56c2da8380caff4b06af840a92b47ccf40759e3537f2fa6ece829af95d34ce09ff801a08a849d7bda1fe22821efdbd98774886d3412f366b724c83b38aa5e5ae345e3e53474d07ca9f5fd4b0ba7f38e89830382d4843116b08c0f1fbb470672141971ad9b67f5c0c4245a9ae893f7ca17595fb32c6e670cedf02a88863cb8d03ee406764ef02e6e6359320259c04aacee754c921f0ff439952b2e8dccda156b93f52a447232734ec2298c6e885769ccbde4d03156bad8819d8443b4869ce8575cde4dc7e6f7e8e59e630eb8c325dc61547c9cf322d0aae734e45f511f71839edef8af43fb1c7116aceb2b077d425b630bf1a4246abda71fe326cc305b6b3462e32c93c9eaf00dc9e84b495a72f26db0a4e1938727a97551b06344d8c0f82aee774714e67f51a508d4214f0ec6de580df03ace11e95c8f22bf332caa093b0e082c706f42590fada140f64d298c52ef6cc93214f836cbc772171324a22529959e4a34dab1b0e52a50a52bad6c5f9f5e450a503d7675e38202c99accd73e5d837c98fb139100cbe8b59fe1c6044ad28aa139140e55f7978ee93e5d67393022ca437d0d167e7ad3538da508b69a40f6a3978a298552f738fe5dbefbb74d8cc5e045e780eae6d50f366902bccf0e335cbfb215258568c1b97a111ea01e35588d0a7a540a32c8cef11caac45e7bbee5b9966c1e086dd20eedd816bf17b388df0f1493d056b02856a434cfe6a2c5d66f65161122335a2e526cd10b1708f810b0ffd4b64b7849b78c30829f55dd1284846599361f2330bc5479cff82abd8b5469da62c06166d04988236597ef3889b7a64b9133902c8a145447a7e379776ac1ead1091b5024b91ccea32080b1dfe6d1730cf5f7e80d3967f37740a635bd968eb8a6e8f35236ec58ac18b9366703e229269c523653c12b852d057b22ceccd4ddf504acaf6caebcb06f74ae35b2e7b3bab5447ddb76aadb2dc7b58cb49da93fbc6db1ed2d965dc1c603c02fb46cee649343ce8624cb2f5f16365a681916672c59204bc5f86e2636b4970bf33dd8d6c49d680a1f140b3887f81fe44f7b0ee5f0251eb3f6d6da860de907955e31173cb407e80b3d043f94e2d878b49a9442901ef6bc92631135de3b93ec6ae62f7df25b12848119cabd1976d3a280f46ec4930b4f1de869126fa6a67d5052b2bec0d6bc50978f5a3a28b0e3120823e2d7f9d9e84773ab097ed9c3ae7ce2e4ae3366f6b088fee21f5e30fd73235043a152c504944fce4159d2e97b102fbb5a8995b4feb2e872d4cdc7072c4bb2dc8fc5245a62a5e5e1776a62411b0546ec8bc27b068e72b43b2285625e9ed06372034502d6de326d97913e29f6464dd437263e0bd98693a3d93b2237e1b985977f183111583865df8eeeec79f4f0c9895f34813df0aeb429c1776e11f84ed2331a62fc2a441a3197d387b2cea4ac2fa017866593cc701d4704807aaf6a2f94e901721aa60b4729c66655036a201d582fbb450f4b40eae81cc98baa4c89a8607703d8c51de7f7f6b6ce7abe06f237ae2e0e7b37f522f3dfa4a741893a28543b62e9db8177b7191e7aabe2c1721691cfab57f7dffca0dd376722cf0b3487f9da18f935b336c4ed72b90f2045176301b2be580c5e5491668ae2b29d94bf324282cb89dec0e45617cf96630b561cac38a2c58ab7da16eff6963850aeac8fb70756a881798c19d7b423a8918d96e21933761b0bc410bfe1bfe6df9c9ea6505dd11dda3c6fe631479ac082e46bd4445a40d649c7b0a322651287f7624dbe5ce721648c841653e60a4b44680f346e83a1e1032ae22b460b02f8d4634e375e3bc2822ceff8fdf379a3a0fc5a1f3dad75a71ae2ee52e88b895dcd01c4d930f74eb99f6330100c8be5f8c90781941fd7e4a6c662b8c938c9abf67d082e8e2fb53d80cb50f9e5f355ab427f34568f0c96d76a09f17ec0a0283f5f517250d07e9bc3c894c51205c67039e59825f0adfc4f6c132ebeff0b5cc51475f6d98f26e04375b530f7cd097cf185d0bf465c84eb26bba889eb26ced5ca6f9b728fa669c50c292b008b87d37b0d7b370671b1cda20de8ed9debe295cd6feb696ccdecca7f316be46934b780603175a79b9be02463adda6a55cd884b55922c5e3a2488a99894c8dea33cf1da61e151dea043b52185f83836afa5511b0dc6726e310b955f782ac77b61d7965c667256b4be0c0ee0331b4624cf498f214ec5871a9280ab4c65722026f1efdd66feb414a45df4ea818716d60310f7f51b866b417ce99a48cb47a88b6720e243504701fe740c42031b0d23c9911268d5eac11db68e1356da5465b2b6119807ecec1430897def8a24ad282237bbc4a5c32d3bf41c844c2193e3f701c4a157ee4387788dcb5787a1759ec9c9fe94d63bfbd10f2ee0022955dc87b7dedd2b0c91275bcf385c67f45fe9364056531b4210f760a97696386d80a21508bba1513c50949248837af682c63896375bb3e7730d0afa3f89c5d2fb64385e3ebb5fba06886ad086866968ddd4a392f38f17c3ce9d67bbdd1ea058ca027e8e204207d29b6ac32b01358366bd30ae3f94a5aead2857244bef676617d8b516ef8f950f87b2fefed6afab85d7e2983cededaf24ce57625e5808e6466bc31cf042dd933624f69704e72ce1f8c9683334da1f9252bdaba94b241e88df1ee3f9f4e0ee7bb2992254add3d13e133bab9a9d3224d1ccc4667cfd53a1a56880b520d2a4f7e1647d5a17fcfbbab8f70ab559c2b84b2fea2e077acf4ae2ce708c174abf2dffe10859b49f0964229b221242cea9a8edab4e400fe16faa41d6d59d43c2dfb84d92ed4764ba76bd5e121d0ee1fe6f8f04162032fd5fc28bfe2e24f2c866567c2d52f749385ee3c3361f5cc6377877596a32080db7d3cf736183cdf3b98d56f0894a69bf849b1e2a84b416fa79a65a7014a3f8e98027020a2c54b863ee92c48540bd413c816a9478d6c7bcbb62542d6fc8c3343bd2a753507436c0133b8bad671168f5c6f99bfc9767e24116defa9ed9af566e24f59e4bbb41387e246e56ad57ae11a97d978183f1657d3763043759f3b2388afd5409f32e651a3d1ee38b1f345799e1d3c1a1917be5f128dc4357eb2d0c5786c65d359b7e5ffface49b6fc5069acd1aba16e746f0f17113096b2773a4e193f6bec6a8ada400493746f9f45305ee8a2bf71c9e699d6d2978daf80db0e1c7cb6d7be819201f45142c6a50d208aa30438dfe35ece98b7476bb9e14c1ac155ca4fc4a37b8445668febd134c0a2aaf7cdd749bcd8757b33308d1f8ffa63a2de525676edd1cd5ff4e269bf2eba0fd547087fde8e69c1503c8fe55b8717afc493bbf4e37465455989724e5ba47059be2128541328e769bfead9c9da687b4ce720a615c352db7010be25969757a8e0317e05e7ce3044034588e021ad21f3b10c70a50e9f19d0143199b3c0daeb8310b9a5ef4b7b949747e652e3e53e1c165f381985aa17ac342c9cca027444b6ce9774a669a4e00f56f55ba8a0085052282c0920addd00f2629ad29fec400d585ea9242db35032b1fa7f78f713ceaadbe98a3a18d2ea7e924681a0261d2ec2aa00862555a67d7ab72733cb9af7165d0c1aa80d9e5acbe05e812989f178b74a10c557922dc462964bec09a88fe682eaa0ef08f069d44f097a90995baee4137e0d43102e801ff5222b5c2cd29381f71c2c873ab19d633e6eff66da1dd6a594ea16b07a2d4c850a5af26e2769cb17d057985b086f0a44aa20ef771b2cf25e0fd974f50c008254e88ab7346035a4267331e46f96a9c7750452561d5e5e3529c4c92326cd1e87a2d7b972361afa4af3d0be8008f23a94813864258cd087101739c9d4ec96ef90a4d6022bc1d6d82bacdcb31364ec0f7c9e466f747fc88cbe79acc8cc7d7e7a35bde87ac118b730d51849540e2973dbfd39be71b028897c4cf532bf8ad4e6b4d22904ffd925176347af57ceb751f68e4789ba0c96caa8612552aede288bcd71e600f601d614c6cfbdcd07246c7d8332b3bb345be2f125e39598afe007748994be4b88d42f2aa8e022641ecc67d86bb09e46aec0c757538e5ce333d4bde30c35eba507d21e2b2f8998b5eac23adb24c404df67c2bb68bb65581d418e4bc3a41af4f980424950d8485130795e3d0c05940003cd201262dfbd4ea660462aa98cf36eeae9dc5124edd9ab8e0cc8a33779fe3ade2712c96ccd8017dce655bf199ba0cb219385cabbc974a02d021204d36c6e84e38ba18c9787cded9b647b155bd800b9a13034a6751f2df902c7b37dcbc6684ee3c113c15abe14c3996956ba9aa3afb3134c9142e2684b7989d646a3a47c00d9c3a71fc470c6cda0a1f7ae31895fe69221d433a8a362dd04590c4881104a749af7f3e31e213f008c8ddb99a37bdf1dcaaf7f88043f21e4911bb257997e57c1a9cda549c149c8de7fcd4f4afcab749da72a4dd4e9133f3fef567aa2dc7a37913a87b7d6caa8902cedc7800d21652309d2146a6da1a723c2e200a0a0ecda93fe020f869cd631e510cd02c14692fdb46f0a3ef06700808408fbb7f42f5b97233515e1e4fbee934cb6d73c90f7a1f3c3e2592adf5078461fcde83c87e091791434f6b45a8820c7d3be5d2bc5ff1916e26e9e173f786905abfdafecd9c2d4d768d4747fa0bcc48b4fd61b8677edb14a55ccff1120feac0047b3e0899b93eaccf0c0cb26dbd3f2b0dc83d6170525c74833b5c6403cd394ad2b1ec9b3c5438a1ee5bd006fd47cfd564280515153b3d3024a45d53e16c9962511b36a86d5c99367605a1baf6624b6eb7c8265899c1f2e541ec43344db297dc0c9dc4f51c7242aa9ab74b423d558c7444ff7af17e791fef5c07ea854e2a52a4e517177ecb1f7aa2ad9ba77bfb9ea3d256d251b70a5861b5c16de59a2cf3f3f8cf42296ebb138fbefd68ad1022f35ffcb943c85945066b9dbd0840e04e824abcbd4d7dc7784b4b761efbbf136496efa1e776c822ea1e50cf271dad7cb7a1a3dbafd8c88ff66727bb18280fc96f8ce6d075d45f024b842df071af29e3f1d73a8feda2ef3a3f82b517e9e0dc5a8713102a8b4311d0e02cb23ae42d7c557d879d8b49b35082e65dba1ce537f6340862a4d3d2bd32eff36c343f533726761b748e4f90f818a4509f919d6226cd9294129323a9b3090c4ad703201d6247cbc61bbc371ae5cf6bba5beb6929b5b5cf1f6dff9edb792534461d392c7264e8e5ac86149aa0968e985680966103f45262c2b873945b06d468370656bc12bd3d263813c8b39d4e24d94c9db74f89cd36dc82dd4c1503d58c733fac2bc259711e62f429eed8475006acaf18e9039c08a5b80baca59fc0792b49d0b028fb8f6407d1192175470fecd006d9add09b6012b7e5f2726d79a11cfc67e7a933bf987f4209b9c7a60c05383161a1caf32648bf09b9d5d1569e238e3e856718a7f016c4ee89212ece9cb3843afd7f2212d4535a2a559fdada47034c6c340e881d935e62b316ed4a209323204d303b9611d5db175a899fbe6927c53f2d47b35bd5e6f4c55c0d9a26e8de3461b2d79edff54cd9348815b419437f609754cb05fd885fa9bc95b1a147e30ca86bc17ac70aa371227a74bfae3b7eb4314f70381d28bc711a8b42457489043c51d1342701c3833fcffee9676238fffa88a25e6393634af776d1f83e252a096b0b338701750e3b982772913a34118dd084918f4f5053f1cdba6edb72c3c38dcd4230aec349f06f01fee3be52e4fa79730ed2c4966af90f200eff512bb9faba96a1f43c7413316f64faf9b6347c71134216b98fa5ad6d474095891f1ebeb7fd9cf4e8c16d325c4c9f269f4ba37113999608b06b489bfd290dae1382195745c69da450687ef924667c40aec66be700db307ad0565cb3bb6850093a41faed1529bf7daabdece39e58f1334eb095f02cd433aefe33fb24e373b7113f8424595e7ebeed3be52bd3622c601527b49b3009548ebc4b2c088d4d22f4be7dc91a4e6c24b6ad245fed7c75e11a815064c6550acbf525b7057790f1f36c3df5a875129736b9e9282ec1f3876ee42bde30d037e89894269d452a70896624442cf562b7ea678c9439fa6a69322959ec741605b51e39450ee5bc3599bc9a62017e736556f3787ef73706fdb5080548cc290fa4f03cdcd057cd851586149c9eb8e0fdff539e22f3d3850a68da1472fb771963fe4fb4cbb118c39d2c7eb1bca64396c0cf563c072e9430922caaba55cdb713990db7496941240ca5f84e4d6f821fea51a139f091fc14d54771201e82912b18d58eaae1620ec0d33735f2efa79c4f775c120d64a249d7c2b708a5edb35c32148d9bae6fa05a6d375ad954cb1123e750a9a686fff67a4db0b128f5b9addbde427e903dfa942e09b92b74bdfd12fc5a8643aef62af028d7c0efe5637fcda995a820aa1a0356521319609e9ff567e9d94775c6b7581fb9d7d2210502f2f878be412105bbed079b011485b3e98bf25edfc6e1327a87e4479af7cfcc0d8b8ea9b2077f0f6a9863393ef3866423bc02ec0f79e6a7d1acb359a5a5e0acb723e4016e761d4ac6b5b37194a84703a6f1dce53956abe459be509bc518acdcbdbe7f37825e8e18130f3827ca5c62775382340dc5ca05006b32cdfdd9922622f7380a10b26f2d82ec55e7e184a39e49f5651d4572dafdb5f6d0ea801e46cad0403f4845601a0d9eb7f355ad293bc77cdb326198e0d3ec6b41966cdd6f1626dec3117af10c58d55efb1928f360445c6bf7db6ea25a1c9681d26392ce4a66f3c0db3db6d7dbb79e3cbd1e16005c82a0f22222c91a5cd6b107aa5215862403265dffd28b0a8d1ca331e61ff1e5b8441a26dd374a0cabd789afc64480c299a475aa26106be49c9f0fefcaf4d98059d77087be852985bdd2936e94b1251055882322745c67d0b5066b655b09c92285b4599c382a0ee013501d2bd2a4bfa2c898ca1bad24a834e3ff2aa4a6f1e5f491e4f04e162c96f41acfd249002b7eb89f1058deb2493eceb37e2489ad308f52d2e2b3f92da74ffcbb675f9bb4e2a89fed5279157c32608d5b3ff99e04a20e263046497fdefd007e5a0db335f0baa0c51560c91ebe63095b0f01ada936599002da5cd9f6bd9baaeaf4f2183112a8772d467a1516c2024a9cd7ea901b2e1da40f85fb8b9eab1b9a7b70afe3b6b4a059d81f577389c7a16979711579b9c755a5acfe33398d289abdaea8b854c956ca84f3c16efab285a52c4580b33f6c614e2c6452032ba6bd731a383089b65b8a111278cbcd0ba8acccfbd3a3b731bda696460007eaed9872be35bb9cc3ad3efa2a6d5c70c5abc00c5f66931b71d3ce74489b0d7cb32b306dbd0f0f119ac8f200f84cddde292a00b72af6c585c9c7af128c9fcdc77bb573d144afd4924f9eafd9e0f8c5413771ece1b135d481dfc632cd373230d6b7183042912090a0084ca09296aac410b9bdf555695d9e54908b0ed497ef40a1f156cea173935d93713cffe6fcde1656721683c8603456bae5675c2f47d635955774ca379f348558cc6e7ea3738fa4ab3e1c48dc0c4e510691cdf2cf5d956b2641165a1293c89d7d5db512a48b5f9d2613a74bc6065c3cb8a0468edf3e607db9aeb990313c19cf08f004343465c636794a85121791e772fb55e50f2c06d16e044fc735dd3e8b121b5ea5917e1d262ec7b01ff84ea9679941f423fb16fb434e2b63c0a120f27029194407edd662bc70539c78f413d78db6f5b9ec4dfa8d4f06792a28f2690030c8aab93e4e5dd44585bbaf689c2482deaa8ab695878fc1b2bfc97f483e7501c6a4574ee096fa5bccd048d4855b85d33cb5ddb28aab4d0b51edc75e9766e91006f2a12dc5f7068eff570d95228fe83a85a3fad3f4b247c649421bbbef3157c0110fded1bd0afba3af0b4397bbe86654443dcef89b82b5d79713a79de6396772a3ebeac5dc223827ccb2c0591223c2bef464a50eba7417ac0eb9bdcba67ce8663e71db1b1b54500d4ee14acb9e168e86edcf1b8648ae3435081f6c36cf2300d397f6def2d7a836b201985809a7afe7e96e86574f2cffdd8f2148eea4493c73bda10700988e0ad1390bba2cc939545b578a74e756078cc9e9259456e7b14842aa8daee00fdebccd8029b86fb507336e9ccdc878e59e835e5262049341f243c38586b395c6137336b30d4b478989084750f61963694ac297a14e89d5010a386ed467b512b455e7ea6a1e912a2e5d057548f871b782bbc944e5c2474464dcc33c421c65da0f3d2f8e8e0a4e0c0a8715c41f515ba5506dea476ae6ff5db50a35229a12d21954e8c6e536cc66941c234420c2abf58f242638d5e786d46762ec3545b3b3468408880637907e55f2a1926e711e81affc6396751aa3bf5238d480581d5fa402021d94eff20532759db50bf34c455252db5977afaecf221eb20e63103fe76f1324e1866b0db79640dac1bbfb80ab795f9c2c443cda1e8b3f4fe717b5a3c15782c41b11e8e4a47a78ac1b9f458a1d5361cbadbca579a4863b3f7d634debaf57713b18f128c84a7cc4ce2859f93118e3d77770c2b2e604cd544b23b41aaab367eeaef64263487ee5776fa14f13864561ac39fe5a67a4c2dddd80bc7f93345ce197a530cfc3b5e518ccdc6730b2b144987a48fa38b74ec5cbb29a2a601275eff3b8b2c358bafac5d4a3a9ab9bc4066bc99fa91c8955d408f82a2f616fe5e44782e703d49c29b9c0c9b560312698c64f38c2f6fcc81cdb6ef42fc0229ae9ed2a9cfba989ea885fd0c1e5e2cd5432fca9944aa4e886d4d267f215d2ec471336d02ccb7955b615b87e525c3e95a60b132a8ba754ef5d0144fd9ed88ef62077fe02e01f39845adfadcc3c3c0f9061a459e01db4f9d214ffd73bab08787fb9fd94ed9b8eb83282487a2b1267094205c486a93b9a4620a66ecc6ff39edc93ec72b7076e19813c2d35bd2eaa1f52962e18fe0a9e1f502308e57995aedff27494dbd909266dfd7cb07e691f783371653071a905c65f026bd8dbad3c8be5889cebb4586905fc12eb5ea3c6a5ef50a694bbeee2519853fb9d237097fc8857149e7313c233bf74a8762f6a80cc59b349ec9958ce64b64de35671072ded3d9132a03de3a9a420c32c23385482588c47b12ed84c85ace884119c184a603b671db328e3550b134b33c0d8460f7996f48f7df2003629fb6046699a997db0187c12d793c3f90ff126a9f9ab5b4ffb6f447e2f089b9bcb210bc392631f3ead3b4a67efcc7098869789f833f5683841f72085111dd73278d4fc175bd8ce56f3d50a594002afd09c2deba63c79bb1b6b4c3fd651526d396444728039dca5077bba01845099f94df09dbfdb98ac87fae31f437c8c18ba2aa8e5be70a2e2f9c498f2755421db31fbeb7cbcf8753a81879741cc10eb38ae34b7dc15d8d4145d289b60dabb80334e9610352edabc48562f31fad9ccb83bba4f555f9fb37cc2aaca4f5eee692097cc0a6c0c45ee846c6231c90ccc48a99ef6558fd4f8eb278899e65a49e38e9bdc80f465dfe9ef9cc58762ee70db0ec3f39ff9afe1e3a0b8ced3c7246070a8bc59c8f04199d850fa2be09414b0005d48ab9027586308d6e94f64d5ae86bd54540827d5da42d5f13e7c9592e9d4187d16eb012c465d1a87a6726b8d62905baed5dd24e130023d9a9b170ad6f758ba4d430ddc7ac047b086dc01273b349402cd703ecf80593ef3d79a668b681be98abf68c4f9e3125edf7e17481a8c21dcf8a842d00361688c7655503bbff4ef3f3b00ae176496e45aa26c1a3d6c3913a8db63d444f3e70d9deb4cc2345ab634e80172b4a43eedd3e2e4b1c6ef1cef097e31461df0ce308124ca030c161c610fbf4217597cd5a1467f7d05641858e05476f058a7107d6726e61fe6901ce9adfea801c94af1655837ab52ada19927423d30fa92279acf6c1549ae6c69d7f99d1c95a8ec9d4e4ed087b666554babd0f38b32ebf6a77b158c1a1c63411fc371ffb0645e5476850f760e1792469cb7f870405b45e0751bf5176e6a0bb179326f76c51be5384685fa495260ecf95f3afd9bb73cda7e9cfad71949527c22edfe644e139f91cf81e0ea62cc8e00a6635d01734b268a5c69ced30cd523d7573b0336aaf9ea2125f58b20c1e58aa5106fc77090726350cdc601ed5829308e85c16c1b50e2da4292fd1780febcb2cd7660fbbe6cd6b85352d7c4dbf69768c316605b2591ff1f727dbd26cdb945fb70f35491738df01d114d6625d83b04975fb5db44d6151dd3edc5873d52cb5ecb4c69f50724f23b952802182db80b93b4e7cd7c4dcda5546bcd232da0709f23e18c04fa4800ff5df312bf2b4655fba6dd3f9bf6abe0151fb3626d0f5eb2a434660e611674545f20d0757014b0932335215bb5c83aa7226de2af18e5edc7e113e9e38be63000cf00e3d719a725f79f7c568807c183c3f3ab98a545406542684895174eb8dadc41656a7fe6b241a045b8cd4c22753c030a8c086093ef6aad2a9c1c6342aa13c29a697281b573b63cb5018fb99291978836bc0fe59090c5669be62f9b810a79a30c06b4876a844cba65a6965691b40776f13b3ad44bea36ca6d66d1c2abef20b79ec54987e79304bd2fa66ef2be26f45e57ded861eab65090666b4bcac05ca828624332e851bc026c8219abe471d450f1c80d492bae4be930df6239c1d57a6ab9ddf90f1daaff6155051d4736c69abf572b4d21e3c0ccc382576c50d115e75e221fa62ede2c15bf2a5361d23f381c14e5163d3c6c3e8b3155ef94dc1b15671e5a4cee0839ad131894301194cbe947c1786234c2f256ba58b8ef1ffd12aef9f69644585a89b5a57febccbe6144c7ecd87442bc4735792cc81c9ba930cf18f6643ba8c9b53015402af6df402d0f03435f0c9a6a22ca81614e59d28c7b914e63c42e365d25b3ec7b48b4bfe274de8dc0bd4d98c563fd70a0d538b16db2696632d1ab9d111354bce0174c801e3405a4c16a6ff4665707ad28f6e351ade9aea04b023f9b863fa9ab6281dc9ebfae67440cea4e9b7d8b6fe4e52f0fac4cadeb4a887e3a9a081230b010ea8b6f597cf2f7b65ccecd4a700c4731ff2f814d0748c2d5ebc66f9dc6aeb7a018ac1b85fd5f960e727c60a1c2b17767465edf5f1cc912e7ffafd83113d98ba5e9708af03921b37dd99376f5e95dc318849cdd8e0daab6bab26b9f63637fdb23263c619d5bcf21b733e44da832936f9363478da62f6dd421fc4c484b4a1a807f90e0343866c1d67cf9cb37240ff81df63e60119153166f0e29a9ca5811ce9804ca7e7e33806032dbcb76f513c17f92c5cb547464a92129590b53fbf7de37ad6d9bbaa9017a203a8f352bf55130cda1547657098a19e973cd4c42f0800e8b01e6fe5250e74d818b06bd81e7fb0361e4587e49e45e9aa862f494fe7807a4628d2cddbc46cbb6bd18903d594b68b093a0f251c9677130f9e79e6fb7917c9cb224fe484800edc1d4c340b397c1adba21f4d234c1105b4af879677cae19f06d212aedbfe676cddbe458939db6ca9dde4f089828a28167d246f5bd83ec3d834c532df10255b83de6f490c88bc7252076bc300e743fa7521a336214f32e8afd91104aa49a60dcac7f6d8590c6c63a3b0be8ec899e8fc8e1b17de3395afe5b598deddd54e9adaf066162c35d23302fd3eb6975d3272cbf717aed0e469510120c40ead67ca6aed1d29d9d0933566b9ad1bf0d5d6877df463f3c50adb0af088e1fca71d1b108a9f35bef771324378b7adf8d97a20f110246446fd72ff2debb322a84a5580890a7e0ef515376f6eb6397a4766c0c26ab0013bd2cef226583a80a63537acc942597fca572665824bcdd1c68ef7805aa66627c704293f45f670b0dd485b492eada484cf21a05d3a119e3ffa744f11d9646fa72cd2c113b318232f154ed973635780ee85126427687610b0400bd9b2393c77cf248fb91e8fe310a8a14ff42b1214d468fbe6ac6eb35b8a7b16a800179f035967e4f657678deddf90d67f5d49d95a574b65f5c95ca46d504ae509188e39b4cd3c3ebeb300a883fa6fc7961c8071bd916d195927440abd8e646d40337c8af5676a69577c1d2996e0800dab2cf4af1e9cc32ca1cc8a79b9fb786eee8651e571af700dc986e8eb087a0e93310f335cd3880b4e95feb6c6dbf6dcf2fa1701babda25e7324f1490793116c4db4df917530af2f79b2dbca5f56c8fe6c50399eebe2f1892a2ce61853f9844ef6ac301851dcdae7f27377466a66bf0416355f03efd713230de21ae42ca5b42d100f1865d17f12069978c9d0b07fded692df97ae0aafed93ba1932ea4dda09817c95400564440b57ab86abf8cfd6954f9add129dd3a83865a5f44aadaf33ce5e236681e5f7561fb8f7f296f763c5e80af0e607715b72d987cc9dd5bbafd8883642da79f8ddd1bf2b21042d62e41393e55976fb45347ac9a329769dcd8d5869ebec0bf57bc0eb226966d7f556211151928bfbc015832f1fbc4677bdbe6c6f7bc7bf5e26c013042e393b64f499444df6270ecb7b331f95893a1a2360885af33915f8b2eacf41fac4ee052f057f4b12a56ce7e247e10e67365de4f6582a29081ef08c9d80907bcdcf97ac1386578389ccd915efe3b92030a7c34bff39ad0c8ccffd65240db47dfde21a9c47ecdcb1c56f315a4036410b186c7099795fe54cda37970876f6901024877b16d99618dd232ed2b3c337e283797ada0b7927fd4adddf30819935184abc180008857ad0d353f1cff15252f3d7793450e45d76caa17d65d2d09b635bc5d971cb7f6bb3aea25faff9a9f962088763661a07081d821809055e32de9ab0bf2860401c8070d2bce1f8ebbc854a643522ae3acdd33a06af419f4fce4a4771b9ed99859bcf27882efd3a22d364e19a7ac6adcf873615af8f76db34d8c7ebeebe7d239e2d27f1e20ae878a676922f7b3fd6f9b9852cfc26e4b94179f18bd897a7639298d82da6306a60b7aa1dcc51b28a8ef36e8844ad31ffdf3040b4b528e6d3e1ebbc0a341f146df39ddb1fb921d987b7a4bdea7bc504d99fef0c77cf3be89fab0d21f95d888f101ab6753d2206f7bdd05cc37f8c5096a08c323ebdeb34d5e2e8346a3915feee3780c3266001384b8533f97079587ddbf3a6fb7eb7f36c46477b87cc3a273113c93944438796ab13616fe769453dffcfea9cae3f0f0dccb33896e0757ee1866c98c06fbe7ac10dd1dc4b28f48a002b67131906312fed6733f892acf48e13815a6bf0b234c88b8f07741cbf5bddb9dbe16d58f5de7a8aa5988dd92dcf19f5719500d6b9bdb3fe590aad12ced06d5c64567a03f491008b195458203e034883345c0c3cfbb4ff1031c2c425f3f73fba2c8d3366019615152818f8dda25e55895ad9d90622d5f75592570dcc53c82ca27617b46d2d2dfc7019c36ae8a2f428a1b9317f2204cb730af1e0052cf81a95c46de7f5e87ce5d4ab9828166c988ce5e1a11966c33c2acb05eeb0045923ce0edd15655dc735e479d6ba9dd7045e8069d9f5146dc205d00325ca692d565a24a2ea6c65af8cd5c69e4039dee7549a574efafb2172d187d16115a01fc2a966fd4c2f8f7518c2d00b02a90facc4142878aa5e1925bc8ade877e954ddafc8a7621a7898a96cc24a41ac263ed9d0a5e459d07b910643037ca99bae0bd633884dbf64a1b5c1cab1faa230632e7779d5517a55abe52304fb122a73f906a6a8a2b53a3cd63d8b4db790ffab5fb593382adaa2b5a4a63a7d478d3128634a0ff3189894050634486d395e79d0c922fd7384f002eab5a2996ffed63d6f7af20a9e3e5278a7f5e8f34db7dc6dc2287e6f8156f647375b898dde4c246d571f59824bf8084df2582947f52ba2a1bde2f279ce5b49fe59ba6d6a38077fc5b2782c8e85c167535c9885587270bab70c03cef4a1d6efc4c310e5053b0de1d89f7cc7275c7b47f17075dc2a5f8096f80ddd8e1d0938058dccad014323f9d21f2644add62b594d9c61c186255c2bf8cdd5540e4e12133928b56559fca014659fcb8f0a198032e25665088dd79577798dbdfd8b0639066926481c6ed04716d9dcf793cd83d033d75ecf148d55f88d5101e934f32dafc3663237d34178ec2fdaf432a8bae61274a063bc8d88097acbbe2d9fbd4210d0bc7b51eaacbcc7ce4bb35fee74bb656b7bd7d7f0d57a682e3f881516b70d427038ef0d1810afdbf22aeaf50c2e314accea679de15f4099ce52bbf9b52f1a0c425ba8af774dd50637363d1e52a44ada1972cdc30f0e3b0dd8256cbf854c81a99844c5b7edadd0af977589daa56da9e8355bcb0e5aba0a515336a9bbc63edadb9c79d82434a48354dc50e9f61c2c1bf8c37dcad64591cca89ffe47d7577dec19ab029db26bb29d4f9c4e4eb85edac9c934b8109dce4f5d871ccc0825116a26940ce23e1db68dce5a6e0cc901d1ab97ca7cc01bb81b635050e91ca1fd7eccf536cfedb7fd112b1214ca1ad64d69300adf033c14de1dba2b741374d9a472796f3090ae3405fccbc98e0763744b1b32b80af15b400d792cf16712c189ba3b797feb0152cf05c93dd6ad71db06107baa9e8f8176a2138503927ad5c0cd867283e93e37eb7e266bf25dc9caa2354af1032e94ad77787ca52803d7faa9ba5448b706fe6c65f8c4fd94bcb0d92d7565ed82039271aecaa85553c91ee8ccb3ed46f327e1513cea6323f81a311152dca2b5f9d3119fee89c0bdb7c547b8d9e5f99855c32d9b837d7d6bf21b3c2e2c5f1601a10de3b14c52cde9eca5c35033d064c7f414ff9e429b99a14835d6b4f4f658c84a1201c38c6f83c9b2549c7ee0fa97a067ccbba5859e5adbe6383d4138f2e8b019c5807016779880f5ccf9a6dd21cf774577a1b5067875e8e34207f8965f1a33a1d1e480993c044eb84317ffa4c97c6a2abf39cb14955db54c597057f16ad0fd99849153df922a60f6066e5c723932da6756c0309170cbc69a6f035c553472195af8ad6b8f0e32552da81e8e47cdb5b7305615cb1b4449b4c9af419551c80023680d3c47b8649daa4724dbbc0ee929710d071409d7e8813b8829c7acf6cff747576708fadcbc3c62585c76ba6b540a0d01e46f05028561094ae6ab52e8a21cc33ae0b38ee73253816c57dcf0a7275f2df70fbad91f7e3566d6dac30cee58ed7908a14478d89566e8d8a46586b747d11e8663871589d2f9d3c1d246d9abd3be492d65f1a61c6344c1cb6affbfbabc365a6a39bbc7c687f7eefda9ea4d5cccc48a61fa52148a0cf7f278e9572bd77af4038dfb5415cd7f627cfd71222e5a382e962dbab17665434c5211ee6862af4d3ee5a1e0ef6072e574490a612dbe80dfd1b4c965020febd1247c069a93a414e887da1071fa7b349720d28e7b6c1291b6f17f0dee1c10828a40415f10b604671dc115f9e9c788eca030bf2b62a08a51c37aee973741e4827ddaa2e2a1a21afe21a3c03d1e0d77f431227ee492b88c29622a6094b44433e93ee6d6d6d58739738f8203ba2966247426eba23e6898baa3ac0f4173cf378515a9fde9a06308b0bbd9cda57992aa2e31e1488af9ced6d9dd66b9e6c30c61e83245cad95f0f4a90253218d69968cd44db3643ecef8c5d4510a9bc05c55db033f76504e10e6607b99e9830f890110d5c2963049eaef1a5ab5dea0e02b9f987dca7504b2a02781c446bd4eb004b9a71473adfc4ce4f0a1662421fb85032e0a474256b5f0a0349c03893fe6232536ded3cfed6c4211369ddc7226fd95e2646f029a2ce6eac0405eb61b9f9b9597c4b2dedb99c0e094ca3167e81eb0c4632911439e4945add01a65224fb57b8561e9353625592b04af549bcd05464f35afd942d6a3de0317b4700f70257cd7ea3e1178b35cb538cbfc70d020ab88cca7eb5433ed4d6f7d93b8caaff18cc99e3e57866f0fc7803acf92b028e7f7894dfbcffa9e0f414218ad9796111af4d279fe552f8d331a407bf2ff250eddce8ab5e6c9678c024208a3b9858af7e3a4839100d6abe14ca9c60965caf8a62004eea8f8f4428599f9d2d29912d24c10819578d7286e24b67c496794b50b9007cfb7086173174439e1d7fe7fd1bdf6c2046b45c2eb06841144e597ba739","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"77e6f901fba9b0f8bbb9f62225d7f4f0"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
